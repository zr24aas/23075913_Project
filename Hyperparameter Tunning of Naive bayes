# Defining the parameter grid
param_grid = {
    'alpha': [0.1, 0.5, 1.0, 1.5, 2.0],
    'fit_prior': [True, False]
}

# Initializing model
nb_basic = MultinomialNB()

# using GridSearchCV with 5-fold cross validation
grid_search = GridSearchCV(
    nb_basic,
    param_grid,
    cv=5,
    scoring='accuracy',
    n_jobs=-1
)

# Fitting on TF-IDF vectors
grid_search.fit(X_train_tfidf, y_train)

# Priniting Best parameters and best score
print("Best Parameters:", grid_search.best_params_)
print("Best CV Accuracy:", grid_search.best_score_)

# Training final model using best params
best_nb = grid_search.best_estimator_

# Evaluating on test set
y_pred = best_nb.predict(X_test_tfidf)
print("\nTest Accuracy:", accuracy_score(y_test, y_pred))
print("\nClassification Report:\n", classification_report(y_test, y_pred))
